function U=spcp(S, Gx, Gy, lambda)
% argmin_U lambda*(U-S)^2 + (Dx_U - Gx)^2 + (Dy_U - Gy)^2


divG = imfilter(Gx, [1 -1 0]) + imfilter(Gy, [1 -1 0]'); 

I=lambda*S + divG;

%w = [0.15 0.5 0.7   0.175 0.547];
%w = [0.1479    0.5010    0.7064    0.1782    0.5455];
%w = [0.1481    0.5011    0.7062    0.1661    0.5382];
%w= [-0.1901   -0.4998   -0.6194    0.1970    0.5612];
w=[0.1481    0.5011    0.7062    0.1661    0.5382];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

h1 = w(1:3);
h1 = [h1 h1(end-1:-1:1)];
h1 = h1' * h1;

h2 = h1;

g = w(4:5);
g = [g g(end-1:-1:1)];
g = g' * g;

U = evalf( I, h1, h2, g );